#!/usr/bin/env bash

# TODO: Validate existence of xclip tool
# TODO: Validate and use BROWSER env variable

declare -A list=( \
  [duckduckgo]=".config/i3/config" \
  [google]="https://www.google.com/search?q=" \
  [translate en->fr]="http://translate.google.com/#en/fr/" \
  [translate fr->en]="http://translate.google.com/#fr/en/"
)

search="$(xclip -o)"
op=$(( for k in "${!list[@]}"; do echo $k; done ) | rofi -dmenu)
url="${list[$op]}"
cmd="sh -c '${BROWSER:-firefox} \"${url}${search}\"'"

# echo "op     = $op"     > $HOME/websearch.log
# echo "url    = $url"    >> $HOME/websearch.log
# echo "search ="         >> $HOME/websearch.log
# echo "$search"          >> $HOME/websearch.log
# echo "cmd    = $cmd"    >> $HOME/websearch.log

[ "$search" ] || { echo "Search selection empty."; exit 1; }
[ "$op" ] || { echo "Unknown search engine."; exit 1; }
eval $cmd

