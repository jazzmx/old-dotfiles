#!/usr/bin/env bash

layout=$@
current="$(setxkbmap -query | sed -rn 's/layout\:[ ]+(.*)$/\1/p')"
us="us"
ca="ca -variant multix"

[ -z "$layout" ] && { echo "$current"; exit; }

case "$layout" in
   -t|toggle) [ "$current" = us ] && setxkbmap $ca || setxkbmap $us ;;
   *) setxkbmap $layout ;;
esac

# Enable digraphs
setxkbmap -option compose:ralt
setxkbmap -query | sed -rn 's/layout\:[ ]+(.*)$/\1/p'

